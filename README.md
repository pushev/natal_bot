# Астрологический сайт - Натальная карта и прогнозы

Веб-приложение для расчёта натальной карты и астрологических прогнозов на основе даты, времени и места рождения.

## Возможности

- Выбор города рождения из справочника городов России (50+ городов)
- Ввод даты и времени рождения
- Автоматический расчёт базовых параметров натальной карты
- Расчёт положений планет (Солнце, Луна, Меркурий, Венера, Марс, Юпитер, Сатурн)
- Определение знаков зодиака для каждой планеты
- **Генерация уникальных персонализированных прогнозов через GPT-4o-mini**
- Детальный прогноз на месяц с рекомендациями по всем сферам жизни
- Кнопка для покупки полного прогноза на год

## Технологии

- **Backend**: Node.js, Express
- **Астрономические расчёты**: astronomy-engine
- **AI генерация прогнозов**: OpenAI GPT-4o-mini
- **Frontend**: Vanilla JavaScript, HTML5, CSS3
- **Данные**: JSON справочник городов России

## Установка

1. Клонируйте репозиторий:
```bash
git clone <url-репозитория>
cd eerun
```

2. Установите зависимости:
```bash
npm install
```

3. **Настройте OpenAI API ключ** (для генерации прогнозов):

   a) Получите API ключ на https://platform.openai.com/api-keys

   b) Создайте файл `.env` в корне проекта:
   ```bash
   cp .env.example .env
   ```

   c) Откройте `.env` и добавьте ваш API ключ:
   ```
   OPENAI_API_KEY=sk-your-api-key-here
   PORT=3000
   ```

   **Важно:** Без API ключа приложение будет работать, но прогнозы будут генерироваться по статическим шаблонам.

4. Запустите сервер:
```bash
npm start
```

5. Откройте браузер и перейдите по адресу:
```
http://localhost:3000
```

## Разработка

Для разработки с автоматической перезагрузкой используйте:
```bash
npm run dev
```

## Структура проекта

```
eerun/
├── server.js           # Основной файл сервера Express
├── package.json        # Зависимости проекта
├── data/
│   └── cities.json     # Справочник городов России
├── public/
│   ├── index.html      # Главная страница с формой
│   ├── forecast.html   # Страница с прогнозом
│   ├── style.css       # Стили
│   ├── app.js          # JavaScript для главной страницы
│   └── forecast.js     # JavaScript для страницы прогноза
└── README.md           # Документация
```

## API Endpoints

### GET /api/cities
Получение списка городов с фильтрацией по поисковому запросу.

**Query параметры:**
- `search` - строка поиска

**Пример:**
```
GET /api/cities?search=Москва
```

### POST /api/calculate
Расчёт натальной карты и прогнозов.

**Body параметры:**
- `city` - название города (строка)
- `date` - дата рождения (формат: YYYY-MM-DD)
- `time` - время рождения (формат: HH:MM)

**Пример:**
```json
{
  "city": "Москва",
  "date": "1990-01-15",
  "time": "14:30"
}
```

**Ответ:**
```json
{
  "success": true,
  "data": {
    "city": {...},
    "birthDate": "...",
    "planets": {...},
    "zodiacSigns": {...},
    "houses": [...],
    "forecast": [...]
  }
}
```

## Как использовать

1. На главной странице введите город рождения (начните вводить название, появится выпадающий список)
2. Выберите дату и время рождения
3. Нажмите кнопку "Рассчитать прогноз"
4. На странице результатов вы увидите:
   - Основные параметры натальной карты (положения планет в знаках зодиака)
   - Прогноз на текущий день
   - Краткие прогнозы на следующие 7 дней
   - Кнопку для покупки полного прогноза на год

## Особенности расчётов

- Используется астрономическая библиотека для точного расчёта положений планет
- Координаты городов используются для более точных расчётов
- Учитывается часовой пояс каждого города
- Прогнозы генерируются на основе транзитов планет и их аспектов к натальным положениям
- **GPT-4o-mini создаёт уникальный прогноз для каждого пользователя** на основе астрологических данных

## Стоимость использования

### С GPT-4o-mini API:
- **~$0.002-0.003** за один прогноз (около 15-20 копеек)
- Прогноз генерируется за 2-4 секунды
- Каждый прогноз уникальный и персонализированный
- Развёрнутый текст на 600-800 слов

### Без API ключа:
- Бесплатно
- Мгновенная генерация
- Статические шаблоны прогнозов
- Базовая персонализация

## Лицензия

MIT
